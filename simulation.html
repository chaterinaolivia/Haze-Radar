<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>HazeRadar — External Wind-Driven Haze Simulation (Dynamic Visuals)</title>

<!-- Bootstrap CSS for styling and layout -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<!-- Leaflet CSS for the map -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
<link rel="stylesheet" href="/css/simulation.css">
</head>
<body>
<div class="app">

<div id="sidebar">
    <h2>Wind-Driven Haze Simulation</h2>

    <a href="index.html" class="btn btn-outline-light btn-sm mb-3">
        ← Back to HazeRadar Map
    </a>
    
    <!-- FIXED DESCRIPTION TEXT -->
    <div class="sidebar-description">
        This model simulates 5 days (120 hours) of haze spread. The plume radius indicates spread over time (age), while color indicates PM2.5 concentration.
    </div>

    <div class="panel">
    <strong>1. Select Starting City</strong>
    <select id="cityDropdown" class="form-select mt-2">
        <option value="">— Select a City —</option>
        <!-- Cities loaded here by JS -->
        <option value="custom">— Set Custom Location on Map —</option>
    </select>
    <div id="customInstructions" class="text-xs text-center text-light-override" style="display:none;">
        Click anywhere on the map to set the starting point.
    </div>
</div>
    
    <div class="panel">
    <strong>2. 5-Day (120 Hour) Wind Forecast (Open-Meteo Fetch)</strong>
    <div id="windForecastDisplay" class="mt-2 text-sm text-light">
        <p class="text-center text-light-override">Select a city or custom location, then press 'Run Haze Simulation'.</p>
    </div>
</div>

<button id="simulateLocal" class="btn btn-primary btn-lg w-100">Run Haze Simulation</button>

    <div id="sliderPanel" class="panel">
    <strong>Timeline Control</strong>
    <input id="hourSlider" type="range" min="1" max="120" value="1">
    <div id="hourLabel" class="mt-2 text-center">Hour: 1</div>
    
        <div class="form-check form-switch mt-3 d-flex justify-content-center">
        <input class="form-check-input" type="checkbox" id="viewModeToggle" checked>
        <label class="form-check-label ms-2" for="viewModeToggle" id="toggleLabel">Cumulative View</label>
    </div>
        
    <!-- CHANGED TO TEXT LINK -->
    <span id="replayBtn" class="w-100 mt-2">Replay Animation</span>
</div>

    <div id="statusBox" class="toastBox">Ready.</div>
</div>

<div id="map"></div>
</div>

<!-- Leaflet JS Library -->
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script src="./js/simulation.js"></script>
</body>
</html>